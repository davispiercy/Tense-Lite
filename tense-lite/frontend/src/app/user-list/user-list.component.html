<div class="title">
  <h1>Users</h1>
</div>

<div class="add-user" *ngIf="authService.isAdmin">
  <!--<div *ngIf="!isChecked">
    <button class="add" (click)="showFormToggle()">Add User</button>
  </div>-->

  <div *ngIf="isChecked" class="form">
    <form [formGroup]="userForm">
      <div *ngIf="editing">
        <h3>Edit User</h3>
      </div>
      <div *ngIf="!editing">
        <h3>New User</h3>
      </div>
      <label for="first-name">First Name: </label>
      <input id="first-name" type="text" formControlName="first_name"> <br>
      <label for="last-name">Last Name: </label>
      <input id="last-name" type="text" formControlName="last_name"> <br>
      <!--<label for="email">Email: </label>
      <input id="email" type="text" formControlName="email"> <br>-->
      <!--<label for="sec_group">Admin</label>
      <input id="sec_group" type="checkbox" formControlName="sec_group"> <br>-->
    </form>
    <div *ngIf="editing">
      <button type="submit" [disabled]="!userForm.valid" (click)="editUser()">Submit</button>
      <button class="cancel" (click)="stopEdit()">Cancel</button>
    </div>
    <div *ngIf="!editing">
      <button type="submit" [disabled]="!userForm.valid" (click)="onSubmit()">Submit</button>
      <button class="cancel" (click)="showFormToggle()">Cancel</button>
    </div>
  </div>
</div>

<div class="active-users" *ngIf="activeUsers$ | async as users; else loading">
  <h3>Active Users</h3>
  <table class="user" *ngFor="let user of users">
    <tr>
      <td>Name:</td>
      <td>{{user.first_name}} {{user.last_name}}</td>
    </tr>
    <tr>
      <td>Email:</td>
      <td>{{user.email}}</td>
    </tr>
    <tr *ngIf="authService.isAdmin">
      <td>Security Group:</td>
      <td>{{user.sec_group}}</td>
    </tr>
    <tr *ngIf="authService.isAdmin">
      <td><button class="edit" (click)="edit(user)">Edit User</button></td>
      <td><button class="disable" (click)="disable(user)">Disable User</button></td>
    </tr>
    <tr *ngIf="authService.isAdmin">
      <td *ngIf="user.sec_group == 'admin'"><button class="remove-admin" (click)="removeAdmin(user)">Revoke Admin</button></td>
      <td *ngIf="user.sec_group != 'admin'"><button class="make-admin" (click)="makeAdmin(user)">Make Admin</button></td>
      <td><button class="assign">Assign to Project</button></td>
    </tr>
    <tr *ngIf="authService.isAdmin">
      <td>Projects</td>
      <td></td>
    </tr>
  </table>
</div>
<div *ngIf="authService.isAdmin">
  <div class="inactive-users" *ngIf="inactiveUsers$ | async as users; else loading">
    <h3>Inactive Users</h3>
    <table class="user" *ngFor="let user of users">
      <tr>
        <td>Name:</td>
        <td>{{user.first_name}} {{user.last_name}}</td>
      </tr>
      <tr>
        <td>Email:</td>
        <td>{{user.email}}</td>
      </tr>
      <tr>
        <td>Security Group:</td>
        <td>{{user.sec_group}}</td>
      </tr>
      <!--<tr>
        <td><button class="edit" (click)="edit(user)">Edit User</button></td>
        <td><button class="enable" (click)="enable(user)">Enable User</button></td>
      </tr>-->
    </table>
  </div>
</div>




<ng-template #loading>Loading...</ng-template>
